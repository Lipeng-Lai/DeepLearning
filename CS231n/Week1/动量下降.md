## 背景:

随着迭代的加深，损失下降变慢



## 原因

### 病态曲率

梯度下降时，沿着某些方向(山谷，峡谷...)前进会陷入停滞，在这些不幸的区域，梯度下降会失败



## 解决方法

动量给予了梯度下降一个短期记忆
$$
z^{k+1} = \beta z^k + \nabla f(w^k) \\
w^{k+1} = w^k - \alpha z^{k+1}
$$
其中当$\beta = 0$时，即是原始的梯度

但当，$\beta = 0.99, 0.999...$，则此时迭代似乎获得了"失去的速度和勇气"，也称为"加速"

类似与从FT(N^2)进化到FFT(NlogN), 快速排序(NlogN)



## 应用

### 第一步：梯度下降

对于一个凸二次方程：
$$
f(w) = \frac{1}{2}w^T Aw - b^Tw, w \in R^n
$$
对于$\nabla f(w)$有，由于矩阵$A$对称且可逆
$$
f(w) = \frac{1}{2}Aw^2 - bw \\
f'(w) = Aw - b
$$
则最优解$w^*$可表示为：
$$
w^* = A^{-1}b
$$
对此，可以对该函数编写一个精确的梯度下降的收敛公式
$$
w^{k+1} = w^k - \alpha(Aw^k - b)
$$
对于对称矩阵$A$，进行特征值分解有
$$
A = Q diag(\lambda_1,...,\lambda_n) Q^T, Q = [q_1,...,q_n]
$$
假设$\lambda_i$是升序排列的，如果改变基础，那么迭代分解变成：
$$
x^{k+1}_i = x^{k}_i - \alpha \lambda_i x_i^k \\
= (1-\alpha \lambda_i)x_i^k \\
= (1-\alpha \lambda_i)^{k+1} x_i^0
$$
回到原先的$w$空间，可以看到
$$
w^k - w^* = Qx^k = \sum_{i}^n x_i^0(1-\alpha \lambda_i)^k q_i
$$
则可以得到了梯度下降的收敛形式



